<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">

    <title>Warframe Tools | Map</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/main.css" rel="stylesheet">
  </head>

  <body cz-shortcut-listen="true" onload="ready()">

    <nav class="navbar navbar-toggleable-md navbar-inverse bg-inverse fixed-top">
      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <a class="navbar-brand" href="index.html">Warframe Tools</a>

      <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html">Cetus</a>
          </li>
		  <li class="nav-item active">
			<a class="nav-link" href="#">Map <span class="sr-only">(current)</span></a>
          </li>
        </ul>
		<button type="button" class="btn btn-outline-success" style="margin-right:5px;cursor:pointer;" data-toggle="modal" data-target="#credits">Map Credits</button>
		<a href="https://github.com/MainlandHero/warframe" class="btn btn-outline-success my-2 my-sm-0">Github Repo</a>
      </div>
    </nav>
	
    <div class="map-container container-fluid">
		<div id="map" class="col-lg-12 h-100"></div>
    </div><!-- /.container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/tether.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>
		<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
		<script>

			var repeatOnXAxis = false;

			/*
			 * Helper function which normalizes the coords so that tiles can repeat across the X-axis (horizontally) like the standard Google map tiles.
			 * ----------------
			 */

				function getNormalizedCoord(coord, zoom) {
					if (!repeatOnXAxis) return coord;

					var y = coord.y;
					var x = coord.x;

					// tile range in one direction range is dependent on zoom level
					// 0 = 1 tile, 1 = 2 tiles, 2 = 4 tiles, 3 = 8 tiles, etc
					var tileRange = 1 << zoom;

					// don't repeat across Y-axis (vertically)
					if (y < 0 || y >= tileRange) {
						return null;
					}

					// repeat across X-axis
					if (x < 0 || x >= tileRange) {
						x = (x % tileRange + tileRange) % tileRange;
					}

					return {
						x: x,
						y: y
					};

				}
				
				// Adds predefined markers to the map
				function addMarkers(map) {
					
					var homeIcon = {
						url: "img/map_icons/home.png",
						origin: new google.maps.Point(0,0),
						anchor: new google.maps.Point(0,0)
					};
					
					var home = [
						['Cetus', -42.68243539838622, 4.5703125, 'Travel gate back to town'],
					];
					
					var fishIcon = {
						url: "img/map_icons/fish.png",
						origin: new google.maps.Point(0,0),
						anchor: new google.maps.Point(0,0)
					};
					
					var fish = [
						['Geyser Pond (Recommended)', -37.71859032558814, -21.09375, 'Pond'],
						['Pond', -22.91792293614603, -20.2148, 'Pond'],
						['Pond', -42.81152174509788, 41.83593, 'Pond'],
						['Pond', 41.9022770409637, 7.55859375, 'Pond'],
						['Pond', 69.2249968541159, -80.332031, 'Pond'],
						['Pond', 23.885837699862, -41.8359375, 'Pond'],
						['Pond', 34.016241889667015, -31.9921, 'Pond'],
						['Pond', -2.284550660236957, -32.3437, 'Pond'],
						['Pond', -30.751277776257812, -51.679, 'Pond'],
						['Pond', 56.656226493502224, -2.46093, 'Pond'],
						['Pond', 53.54030739150022, 16.171875, 'Pond'],
						['Pond', 40.17887331434696, -89.64843, 'Pond'],
						['Pond', 49.72447918871298, 59.4140625, 'Pond'],
						['Sea', -58.90464570301998, -76.2890, 'Sea'],
						['Sea (Recommended)', -31.05293398570514, -101.953, 'Sea'],
						['Sea (Recommended)', -43.58039085560784, -103.535, 'Sea'],
						['Sea (Recommended)', -70.31873847853122, 63.98437, 'Sea'],
						['Sea (Recommended)', -69.7789517764676, 91.230468, 'Sea'],
						['Sentient Lake (Recommended)', -6.4899833326706515, 12.8320, 'Lake'],
					];
					
					var fishInfo = [
						['Pond', 'Khut Khut (Day)<br>Yogwun (Day)<br>Mortus Lungfish<br>Cuthol* (Night)<br><br><b>*Peppered Bait Required</b>'],
						['Lake', 'Charc Eel<br>Mawfish (Day)<br>Norg*<br><br><b>*Peppered Bait Required</b>'],
						['Sea', 'Goopola<br>Karkina*<br>Sharrac*<br>Tralok (Day)<br>Murkray*<br>Glappid* (Night)<br><br><b>*Peppered Bait Required</b>'],
					];
					
					var caveIcon = {
						url: "img/map_icons/caves.png",
						origin: new google.maps.Point(0,0),
						anchor: new google.maps.Point(0,0)
					};
					
					var cave = [
						['Cave', -40.044437584608566, -24.785, ''],
						['Cave', -52.16045455774704, -33.5742, ''],
						['Cave', -38.95940879245421, -92.4609, ''],
						['Cave', 12.211180191503997, -87.7148, ''],
						['Cave', -31.353636941500987, -56.777, ''],
						['Cave', -58.631216643424786, 56.4257, ''],
						['Cave', -66.08936427047087, 91.23046, ''],
						['Cave', 13.068776734357693, 85.07812, ''],
						['Cave', 9.795677582829745, 58.183593, ''],
						['Cave', 35.17380831799959, 78.222656, ''],
						['Cave', 51.94426487902877, 62.578125, ''],
						['Cave', 64.16810689799152, -50.97656, ''],
					];
					
					var grineerIcon = {
						url: "img/map_icons/grineer.png",
						origin: new google.maps.Point(0,0),
						anchor: new google.maps.Point(0,0)
					};
					
					var grineer = [
						['Grineer Sea Spire Base', -35.7465122599185, -90.52734, ''],
						['Grineer Excavation Site', -6.839169626342807, -17.5781, ''],
						['Grineer Mountain Base', 64.01449619484472, -45.3515625, ''],
						['Grineer Firepit Base', 65.94647177615738, 14.0625, ''],
						['Grineer Radar Base', 37.85750715625203, 68.02734375, ''],
						['Grineer East Outpost', -56.94497418085159, 65.21484375, ''],
					];
					
					var infowindow = new google.maps.InfoWindow();
					
					// Home icon loop
					for (var i = 0; i < home.length; i++){
						var marker = new google.maps.Marker({
							position: new google.maps.LatLng(home[i][1], home[i][2]),
							map: map,
							icon: homeIcon,
							title: home[i][0],
							optimized: false
						});
						
						google.maps.event.addListener(marker, 'click', (function (marker, i) {
							return function () {
								infowindow.setContent("<h6>" + home[i][0] + "</h6>" + home[i][3]);
								infowindow.open(map, marker);
							}
						})(marker, i)); 
					}
					
					// Fish icon loop
					for (var i = 0; i < fish.length; i++){
						var marker = new google.maps.Marker({
							position: new google.maps.LatLng(fish[i][1], fish[i][2]),
							map: map,
							icon: fishIcon,
							title: fish[i][0],
							optimized: false
						});
						
						google.maps.event.addListener(marker, 'click', (function (marker, i) {
							return function () {
								if(fish[i][3] === 'Pond'){
									infowindow.setContent("<h6>" + fish[i][0] + "</h6>" + fishInfo[0][1]);
								}
								else if(fish[i][3] === 'Lake'){
									infowindow.setContent("<h6>" + fish[i][0] + "</h6>" + fishInfo[1][1]);
								}
								else{
									infowindow.setContent("<h6>" + fish[i][0] + "</h6>" + fishInfo[2][1]);
								}
								infowindow.open(map, marker);
							}
						})(marker, i)); 
					}
					
					// Cave icon loop
					for (var i = 0; i < cave.length; i++){
						var marker = new google.maps.Marker({
							position: new google.maps.LatLng(cave[i][1], cave[i][2]),
							map: map,
							icon: caveIcon,
							title: cave[i][0],
							optimized: false
						});
						
						google.maps.event.addListener(marker, 'click', (function (marker, i) {
							return function () {
								infowindow.setContent("<h6>" + cave[i][0] + "</h6>" + cave[i][3]);
								infowindow.open(map, marker);
							}
						})(marker, i)); 
					}
					
					// Grineer icon loop
					for (var i = 0; i < grineer.length; i++){
						var marker = new google.maps.Marker({
							position: new google.maps.LatLng(grineer[i][1], grineer[i][2]),
							map: map,
							icon: grineerIcon,
							title: grineer[i][0],
							optimized: false
						});
						
						google.maps.event.addListener(marker, 'click', (function (marker, i) {
							return function () {
								infowindow.setContent("<h6>" + grineer[i][0] + "</h6>" + grineer[i][3]);
								infowindow.open(map, marker);
							}
						})(marker, i)); 
					}
				}


			/*
			 * Main Core
			 * ----------------
			 */

				window.onload = function() {

					// Define our custom map type
					var customMapType = new google.maps.ImageMapType({
						getTileUrl: function(coord, zoom) {
							var normalizedCoord = getNormalizedCoord(coord, zoom);
							if(normalizedCoord && (normalizedCoord.x < Math.pow(2, zoom)) && (normalizedCoord.x > -1) && (normalizedCoord.y < Math.pow(2, zoom)) && (normalizedCoord.y > -1)) {
								return 'img/plains/' + zoom + '_' + normalizedCoord.x + '_' + normalizedCoord.y + '.jpg';
							} else {
								return 'img/plains/empty.jpg';
							}
						},
						tileSize: new google.maps.Size(256, 256),
						maxZoom: 5,
						name: 'Plains of Eidolon'
					});

					// Basic options for our map
					var myOptions = {
						center: new google.maps.LatLng(0, 0),
						zoom: 3,
						minZoom: 3,
						streetViewControl: false,
						mapTypeControl: false,
						mapTypeControlOptions: {
							mapTypeIds: ["custom"]
						}
					};

					// Init the map and hook our custom map type to it
					var map = new google.maps.Map(document.getElementById('map'), myOptions);
					
					// This event listener when the map is clicked, output lat and lon to console
					google.maps.event.addListener(map, 'click', function(event) {
						console.log(JSON.stringify(event.latLng));
					});
					
					google.maps.event.addListener(map, 'center_changed', function() {
						checkBounds();
					});

					function checkBounds() {
					
						var allowedBounds = new google.maps.LatLngBounds(
							new google.maps.LatLng(-65.0, -80.0),
							new google.maps.LatLng(65.0, 80.0));
						
						if(allowedBounds.contains(map.getCenter())) {
							return;
						}
						
						var mapCenter = map.getCenter();
						var X = mapCenter.lng();
						var Y = mapCenter.lat();

						var AmaxX = allowedBounds.getNorthEast().lng();
						var AmaxY = allowedBounds.getNorthEast().lat();
						var AminX = allowedBounds.getSouthWest().lng();
						var AminY = allowedBounds.getSouthWest().lat();
			 
						if (X < AminX) {X = AminX;}
						if (X > AmaxX) {X = AmaxX;}
						if (Y < AminY) {Y = AminY;}
						if (Y > AmaxY) {Y = AmaxY;}
				   
						map.setCenter(new google.maps.LatLng(Y,X));
					}
					
					addMarkers(map);
					
					map.mapTypes.set('custom', customMapType);
					map.setMapTypeId('custom');

				}
				
		</script>
		
		<!-- Map Credits -->
		<div class="modal fade" id="credits" tabindex="-1" role="dialog" aria-labelledby="creditsLabel" aria-hidden="true">
		  <div class="modal-dialog" role="document">
			<div class="modal-content">
			  <div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">Map Credits</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
				  <span aria-hidden="true">&times;</span>
				</button>
			  </div>
			  <div class="modal-body">
				This map was made possible by /u/Major_Techie
				<br><a href="https://www.reddit.com/r/Warframe/comments/76b96g/i_stitched_together_the_plains_of_eidolon_map_for/" target="_blank">Original Reddit Post</a>
				<br><br>
				Fish information made by /u/cranem258 and the amazing Warframe community
				<br><a href="https://docs.google.com/spreadsheets/d/13vN9qnVuPSkHiLHTJZ_CjImaekcMY2tC3cNCcQCCVP8/htmlview?sle=true" target="_blank">Detailed fishing information</a>
				<br><br>
				General information by /u/Cammo_353
				<br><a href="https://www.reddit.com/r/Warframe/comments/76ivu5/i_made_a_plains_of_eidolon_field_guide/" target="_blank">Reddit Guide Thread</a>
			  </div>
			  <div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			  </div>
			</div>
		  </div>
		</div>

</body></html>